<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Girls Soccer Camp</title>

  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/girlcamp.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
</head>

<body>

<!-- HEADER -->
<div id="header"></div>

<div class="page-container">

  <h1>Girls Soccer Camp</h1>

  <!-- BOX AZIONI -->
  <div class="girls-cards">

    <div class="girls-card new" onclick="openPopup()">
      <i class="fa-solid fa-user-plus"></i>
      <h2>Nuova Iscritta</h2>
    </div>

    <div class="girls-card archive" onclick="openArchivio()">
      <i class="fa-solid fa-folder-open"></i>
      <h2>Archivio Atlete</h2>
    </div>

  </div>

</div>

<!-- =========================
     POPUP NUOVA ISCRIZIONE
========================= -->

<div id="iscrizioneModal" class="modal">

  <div class="modal-large">

    <!-- HEADER POPUP -->
    <div class="modal-header">

      <h2>Nuova Iscrizione</h2>

      <div class="modal-tabs">
        <button class="tab-btn active" onclick="showManuale()">Inserimento Manuale</button>
        <button class="tab-btn" onclick="showImport()">Import Excel</button>
      </div>

      <span class="close-x" onclick="closeIscrizionePopup()">‚úñ</span>

    </div>

    <!-- ================= MANUALE ================= -->
   <div id="manualeContent" class="modal-body">

  <!-- =========================
       DATI GIOCATORE
  ========================= -->
  <div class="section-card">

    <h3>üë§ Dati Giocatore</h3>

    <div class="form-grid">

      <input type="text" placeholder="Nome">
      <input type="text" placeholder="Cognome">

      <input type="date">
      <input type="text" placeholder="Luogo di Nascita">

      <input type="text" placeholder="Classe">

      <!-- RUOLO PREIMPOSTATO -->
      <select>
        <option>Ruolo</option>
        <option>Portiere</option>
        <option>Difensore</option>
        <option>Centrocampista</option>
        <option>Attaccante</option>
      </select>

    </div>

  </div>

  <!-- =========================
       DATI FISICI
  ========================= -->
  <div class="section-card">

    <h3>üìè Dati Fisici</h3>

    <div class="fisici-grid">

      <input type="number" placeholder="Altezza cm">
      <input type="text" placeholder="Taglia">
      <input type="number" placeholder="Scarpa">

    </div>

  </div>

  <!-- =========================
       DOCUMENTI
  ========================= -->
  <div class="section-card">

    <h3>üìÑ Documenti</h3>

    <div class="toggle-grid">

      <div class="toggle red">Cert. Medico</div>
      <div class="toggle red">Tessera Sanitaria</div>
      <div class="toggle red">Documento Identit√†</div>
      <div class="toggle red">Cert. Vaccinazioni</div>
      <div class="toggle red">Firme Moduli</div>

    </div>

  </div>

  <!-- =========================
       ALLERGIE
  ========================= -->
  <div class="section-card">

    <h3>ü©∫ Allergie / Intolleranze</h3>

    <div class="toggle-grid">

      <div class="toggle red allergia-btn"
     onclick="toggleAllergie(this, true)">SI</div>

<div class="toggle red allergia-btn"
     onclick="toggleAllergie(this, false)">NO</div>

    </div>

    <textarea id="boxAllergie" class="hidden" placeholder="Descrizione Allergie..."></textarea>

  </div>

  <!-- =========================
       CONTATTI
  ========================= -->
  <div class="section-card">

    <h3>üìû Contatti</h3>

    <div class="form-grid">

      <input type="text" placeholder="Telefono 1">
      <input type="text" placeholder="Telefono 2">
      <input type="text" placeholder="Indirizzo">
      <input type="email" placeholder="Email">

    </div>

  </div>

  <!-- =========================
       NOTE
  ========================= -->
  <div class="section-card">

    <h3>üìù Note</h3>
    <textarea placeholder="Note..."></textarea>

  </div>

  <!-- =========================
       SETTIMANE
  ========================= -->
  <div class="section-card">

    <h3>üìÖ Settimane</h3>

    <div id="settimaneToggle" class="toggle-grid">
      <!-- Firebase -->
    </div>

  </div>

  <div class="modal-footer">
    <button class="save-btn">Salva Iscrizione</button>
  </div>

</div>

<!-- =========================
     PAGAMENTO
========================= -->
<div class="section-card">

  <h3>üí∞ Pagamento</h3>

  <div class="pagamento-grid">

    <div>
      <label>Totale da Pagare</label>
      <input type="text" id="totalePagamento" readonly>
    </div>

    <div>
      <label>Acconto Versato</label>
      <input type="number" id="accontoPagamento">
    </div>

    <div>
      <label>Rimanenza</label>
      <input type="text" id="restoPagamento" readonly>
    </div>

  </div>

</div>
    <!-- ================= IMPORT ================= -->
    <div id="importContent" class="modal-body hidden">

      <h3>Importa da File Excel</h3>

      <input type="file" accept=".xlsx,.xls">

      <div class="modal-footer">
        <button class="save-btn">Carica File</button>
      </div>

    </div>

  </div>

</div>

<!-- =========================
     SCRIPT
========================= -->

<script>

  // FIREBASE
  const firebaseConfig = {
    apiKey: "AIzaSyDVomjMP2gDUy_mEIe-tnVf4hEdF7GFvws",
    authDomain: "gestionale-maluscicamp.firebaseapp.com",
    projectId: "gestionale-maluscicamp",
    storageBucket: "gestionale-maluscicamp.appspot.com",
    messagingSenderId: "615282026849",
    appId: "1:615282026849:web:bf46adfca227570d7d7d20"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // =========================
// CARICA SETTIMANE FIREBASE
// =========================
function caricaSettimane() {

  const container = document.getElementById("settimaneToggle");

  container.innerHTML = "";

  db.collection("settimane")
    .orderBy("createdAt")
    .get()
    .then((querySnapshot) => {

      querySnapshot.forEach((doc) => {

        const data = doc.data();

        const box = document.createElement("div");

        box.className = "toggle red";
        box.innerText = data.nome;

        // SALVIAMO ID SETTIMANA
        box.dataset.id = doc.id;

        container.appendChild(box);

      });

    });

}

  // HEADER LOAD
  fetch("components/header.html")
    .then(res => res.text())
    .then(data => {
      document.getElementById("header").innerHTML = data;
    });

  // NAVIGAZIONE HEADER
  function goDashboard() {
    window.location.href = "dashboard.html";
  }

  function goBack() {
    window.history.back();
  }

  // POPUP
  function openPopup() {
  document.getElementById("iscrizioneModal").style.display = "flex";
  caricaSettimane();
}

  function closeIscrizionePopup() {
    document.getElementById("iscrizioneModal").style.display = "none";
  }

  function openArchivio() {
    alert("Archivio Atlete - Step successivo");
  }

  // TAB SWITCH
  function showManuale() {
    document.getElementById("manualeContent").classList.remove("hidden");
    document.getElementById("importContent").classList.add("hidden");
  }

  function showImport() {
    document.getElementById("manualeContent").classList.add("hidden");
    document.getElementById("importContent").classList.remove("hidden");
  }

</script>
<script>

// =========================
// TOGGLE DOCUMENTI + SETTIMANE
// =========================
document.addEventListener("click", function(e) {

  if (e.target.classList.contains("toggle") &&
      !e.target.classList.contains("allergia-btn")) {

    e.target.classList.toggle("red");
    e.target.classList.toggle("green");
  }

});


// =========================
// TOGGLE ALLERGIE
// =========================
function toggleAllergie(element, stato) {

  const buttons = document.querySelectorAll(".allergia-btn");

  buttons.forEach(btn => {
    btn.classList.remove("green");
    btn.classList.add("red");
  });

  element.classList.remove("red");
  element.classList.add("green");

  const box = document.getElementById("boxAllergie");

  if (stato) {
    box.classList.remove("hidden");
  } else {
    box.classList.add("hidden");
  }

}

</script>

</body>
</html>